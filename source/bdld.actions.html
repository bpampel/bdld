
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>bdld.actions package &#8212; Birth-Death Langevin Dynamics v0.3.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="bdld-actions-package">
<h1>bdld.actions package<a class="headerlink" href="#bdld-actions-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-bdld.actions.action">
<span id="bdld-actions-action-module"></span><h2>bdld.actions.action module<a class="headerlink" href="#module-bdld.actions.action" title="Permalink to this heading">¶</a></h2>
<p>Module containing the abstract base class for all actions</p>
<p>Also has helper functions used by multiple actions</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.action.Action">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.action.</span></span><span class="sig-name descname"><span class="pre">Action</span></span><a class="headerlink" href="#bdld.actions.action.Action" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for all actions</p>
<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.action.Action.final_run">
<span class="sig-name descname"><span class="pre">final_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.action.Action.final_run" title="Permalink to this definition">¶</a></dt>
<dd><p>If not implemented, do nothing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.action.Action.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.action.Action.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Needs to be defined for all actions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.action.get_valid_data">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.action.</span></span><span class="sig-name descname"><span class="pre">get_valid_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_write</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.action.get_valid_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the currently valid rows as a view of the data array</p>
<p>This is required to for actions storing their data continuously that also want to
be able to write / reset their data array at any time</p>
<p>The data array is assumed to have the following properties:</p>
<ul class="simple">
<li><p>it is filled every update_stride, the first step is 1, not 0</p></li>
<li><p>after the last element is reached the first is written again,
all previously stored data is no longer valid</p></li>
<li><p>nothing influences this order, e.g. even a reset will continue writing the next
element instead of starting from the beginning</p></li>
</ul>
<p>This results in several assumptions on the arguments, which are not checked!</p>
<ul class="simple">
<li><p>the write_stride must be a multiple of the update_stride</p></li>
<li><p>the last_write argument should not refer to a step before the last rewrite
from the beginning</p></li>
<li><p>the stride argument must be a multiple of the update_stride</p></li>
</ul>
<p>if these are not satisfied the returned data will not be correct.</p>
<p>The stride argument makes the function only return the data of every nth time step.
It is placed here for calling this function regularly, because if the array size is
not a multiple, an offset has to be taken into account from the previous times</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – data array whose valid rows are returned, each row represents a point in time</p></li>
<li><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Return only data points of every nth time step (not stride of data points!)</p></li>
<li><p><strong>update_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of time steps between data points</p></li>
<li><p><strong>last_write</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – when the data was last written (needs to be less than write_stride ago)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bdld.actions.birth_death">
<span id="bdld-actions-birth-death-module"></span><h2>bdld.actions.birth_death module<a class="headerlink" href="#module-bdld.actions.birth_death" title="Permalink to this heading">¶</a></h2>
<p>Birth death algorithm</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.birth_death.ApproxVariant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.birth_death.</span></span><span class="sig-name descname"><span class="pre">ApproxVariant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.ApproxVariant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Enum for the different approximation variants</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bdld.actions.birth_death.ApproxVariant.add">
<span class="sig-name descname"><span class="pre">add</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'additive'</span></em><a class="headerlink" href="#bdld.actions.birth_death.ApproxVariant.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.ApproxVariant.from_str">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.ApproxVariant.from_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Return class instance from matching string</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bdld.actions.birth_death.ApproxVariant" title="bdld.actions.birth_death.ApproxVariant"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApproxVariant</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bdld.actions.birth_death.ApproxVariant.mult">
<span class="sig-name descname"><span class="pre">mult</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'multiplicative'</span></em><a class="headerlink" href="#bdld.actions.birth_death.ApproxVariant.mult" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bdld.actions.birth_death.ApproxVariant.orig">
<span class="sig-name descname"><span class="pre">orig</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'original'</span></em><a class="headerlink" href="#bdld.actions.birth_death.ApproxVariant.orig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.birth_death.</span></span><span class="sig-name descname"><span class="pre">BirthDeath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">md_dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalc_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#bdld.actions.action.Action" title="bdld.actions.action.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a></p>
<p>Birth death algorithm.</p>
<p>This has a lot of instance attributes, containing also some statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#bdld.actions.bussi_parinello_ld.BpldParticle" title="bdld.actions.bussi_parinello_ld.BpldParticle"><code class="xref py py-class docutils literal notranslate"><span class="pre">BpldParticle</span></code></a>]) – list of Particles shared with MD</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of MD timesteps between birth-death exectutions</p></li>
<li><p><strong>dt</strong> – time between subsequent birth-death evaluations</p></li>
<li><p><strong>kt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – thermal energy of system</p></li>
<li><p><strong>inv_kt</strong> – inverse of kt for faster access</p></li>
<li><p><strong>bw</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – bandwidth for gaussian kernels per direction</p></li>
<li><p><strong>rate_fac</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – factor for b/d probabilities in exponential</p></li>
<li><p><strong>approx_variant</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#bdld.actions.birth_death.ApproxVariant" title="bdld.actions.birth_death.ApproxVariant"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApproxVariant</span></code></a>]) – type of approximation (lambda)</p></li>
<li><p><strong>approx_grid</strong> – helper grid storing some values depending only on pi
Note that this has different values depending on the
variant (additive / multiplicative)</p></li>
<li><p><strong>rng</strong> – random number generator instance for birth-death moves</p></li>
<li><p><strong>stats</strong> – Stats class instance collecting statistics</p></li>
</ul>
</dd>
</dl>
<p>:raises</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.Stats">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bd_action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.Stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple data class for grouping the stats</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dup_count</strong> – number of accepted duplication events</p></li>
<li><p><strong>dup_atempts</strong> – number of attempted duplication events</p></li>
<li><p><strong>kill_count</strong> – number of accepted kill events</p></li>
<li><p><strong>kill_atempts</strong> – number of attempted kill events</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.Stats.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.Stats.print" title="Permalink to this definition">¶</a></dt>
<dd><p>Print birth/death probabilities to file or screen</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.Stats.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.Stats.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all logging counters to zero</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.calc_betas">
<span class="sig-name descname"><span class="pre">calc_betas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.calc_betas" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the birth/death rate for every particle</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.do_birth_death">
<span class="sig-name descname"><span class="pre">do_birth_death</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.do_birth_death" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate which particles to kill and duplicate and perform the task</p>
<p>The particles will be processed in random order
By default the beta values will be evaluated only once at the beginning,
set recalc_probs to change this behavior</p>
<dl class="field-list simple">
<dt class="field-odd">Return event_list<span class="colon">:</span></dt>
<dd class="field-odd"><p>List with Tuples (dup_i, kill_i) of the accepted events</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.final_run">
<span class="sig-name descname"><span class="pre">final_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.final_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Print out stats if they were not before</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.perform_moves">
<span class="sig-name descname"><span class="pre">perform_moves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.perform_moves" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the birth-death moves given in the event_list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event_list</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – List with Tuples(i,j) of the particle numbers.
Particle j will be replaced by a copy of particle i</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.random_other">
<span class="sig-name descname"><span class="pre">random_other</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.random_other" title="Permalink to this definition">¶</a></dt>
<dd><p>Select random particle while excluding the one given as second argument</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_part</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – total number of particles</p></li>
<li><p><strong>excl</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – particle to exclude</p></li>
</ul>
</dd>
<dt class="field-even">Return num<span class="colon">:</span></dt>
<dd class="field-even"><p>random particle</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform birth-death step on particles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current timestep of simulation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.birth_death.BirthDeath.walker_density_grid">
<span class="sig-name descname"><span class="pre">walker_density_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.BirthDeath.walker_density_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the density of walkers and bd-probabilities on a grid</p>
<p>This function is a relict and currently not used anywhere in the code
Kept here for possible debugging at a later time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – positions to calculate the kernel values</p></li>
<li><p><strong>energy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – energies of the grid values</p></li>
</ul>
</dd>
<dt class="field-even">Return array<span class="colon">:</span></dt>
<dd class="field-even"><p>grid rho beta</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.birth_death.calc_additive_correction">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.birth_death.</span></span><span class="sig-name descname"><span class="pre">calc_additive_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.calc_additive_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Additive correction for the probabilites due to the Gaussian Kernel</p>
<p>Calculates the following two terms from the Kernel K and equilibrium walker distribution pi
.. :math::
-log((K(x) * pi(x)) / pi(x)) + int (log((K(x) * pi(x)) / pi(x))) pi mathrm{d}x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_density</strong> (<a class="reference internal" href="bdld.html#bdld.grid.Grid" title="bdld.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>) – grid with equilibrium probability density of system</p></li>
<li><p><strong>bw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – bandwidths of the kernel (sigma)</p></li>
<li><p><strong>conv_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – convolution mode to use. See dens_kernel_convolution() for details.</p></li>
</ul>
</dd>
<dt class="field-even">Return correction<span class="colon">:</span></dt>
<dd class="field-even"><p>grid wih the correction values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="bdld.html#bdld.grid.Grid" title="bdld.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.birth_death.calc_kernel">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.birth_death.</span></span><span class="sig-name descname"><span class="pre">calc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.calc_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return kernel values from the distances to center</p>
<p>Currently directly returns Gaussian kernel
other kernels could later be implemented via string argument</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – array of shape (n_dist, n_dim) with distances per dimensions</p></li>
<li><p><strong>bw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – bandwidth per dimension</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.birth_death.dens_kernel_convolution">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.birth_death.</span></span><span class="sig-name descname"><span class="pre">dens_kernel_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.dens_kernel_convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return convolution of the a probability density with the kernel</p>
<p>This is equivalent to doing a kernel density estimation</p>
<p>In practice only used to calculate K * pi, i.e. the KDE of the equilibrium density</p>
<p>If the “valid” conv_mode is used the returned grid is smaller than the original one.
The “same” mode will return a grid with the same ranges, but might have issues
due to edge effects from the convolution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_density</strong> (<a class="reference internal" href="bdld.html#bdld.grid.Grid" title="bdld.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>) – grid with equilibrium probability density of system</p></li>
<li><p><strong>bw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – bandwidths of the kernel (sigma)</p></li>
<li><p><strong>conv_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – convolution mode to use (affects output size).
If ‘valid’ the resulting correction grid will have a
smaller domain than the original eq_density one.
If ‘same’ it will use exactly the ranges of the original grid.</p></li>
</ul>
</dd>
<dt class="field-even">Return conv<span class="colon">:</span></dt>
<dd class="field-even"><p>grid holding the convolution values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="bdld.html#bdld.grid.Grid" title="bdld.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.birth_death.nd_trapz">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.birth_death.</span></span><span class="sig-name descname"><span class="pre">nd_trapz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.nd_trapz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a multidimensional integral via recursive usage of the trapezoidal rule</p>
<p>Uses numpy’s trapz for the 1d integrals</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – values to integrate</p></li>
<li><p><strong>dx</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – distances between datapoints per dimension</p></li>
</ul>
</dd>
<dt class="field-even">Return integral<span class="colon">:</span></dt>
<dd class="field-even"><p>integral value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.birth_death.walker_density">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.birth_death.</span></span><span class="sig-name descname"><span class="pre">walker_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.birth_death.walker_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the local density at each walker (average kernel value)</p>
<p>The actual calculations are done by the different _walker_density functions
depending on the number of walkers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>numpy.ndarray</em>) – positions of particles</p></li>
<li><p><strong>bw</strong> (<em>float</em>) – bandwidth parameter of kernel</p></li>
</ul>
</dd>
<dt class="field-even">Return numpy.ndarray kernel<span class="colon">:</span></dt>
<dd class="field-even"><p>kernel value matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bdld.actions.bussi_parinello_ld">
<span id="bdld-actions-bussi-parinello-ld-module"></span><h2>bdld.actions.bussi_parinello_ld module<a class="headerlink" href="#module-bdld.actions.bussi_parinello_ld" title="Permalink to this heading">¶</a></h2>
<p>Simple Langevin Dynamics with Bussi-Parinello thermostat</p>
<p>This is an implementation of the algorithm introduced in
<a class="reference external" href="https://doi.org/10.1103/PhysRevE.75.056707">https://doi.org/10.1103/PhysRevE.75.056707</a>
see there for reasoning and further details</p>
<p>It works by introducing thermostat steps between the velocity Verlet ones, the
algorithm is designed to yield also the correct sampling in the overdamped limit</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.bussi_parinello_ld.BpldParticle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.bussi_parinello_ld.</span></span><span class="sig-name descname"><span class="pre">BpldParticle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.bussi_parinello_ld.BpldParticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="bdld.html#bdld.particle.Particle" title="bdld.particle.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a></p>
<p>Derived Particle class that additionally stores MD related variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy</strong> – stores last energy evaluation</p></li>
<li><p><strong>forces</strong> – stores last force evaluation per dimension</p></li>
<li><p><strong>c2</strong> – constant for the MD thermostat (mass dependent)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.bussi_parinello_ld.BussiParinelloLD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.bussi_parinello_ld.</span></span><span class="sig-name descname"><span class="pre">BussiParinelloLD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">friction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.bussi_parinello_ld.BussiParinelloLD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#bdld.actions.action.Action" title="bdld.actions.action.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a></p>
<p>Perform Langevin Dynamics with Bussi-Parinello thermostat</p>
<p>Can handle multiple non-interacting particles (= walkers) simultaneously</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pot</strong> (<a class="reference internal" href="bdld.potential.html#bdld.potential.potential.Potential" title="bdld.potential.potential.Potential"><code class="xref py py-class docutils literal notranslate"><span class="pre">Potential</span></code></a>) – potential to perform LD on</p></li>
<li><p><strong>dt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – timestep</p></li>
<li><p><strong>friction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – friction parameter of langevin equation</p></li>
<li><p><strong>kt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – thermal energy in units of kt</p></li>
<li><p><strong>rng</strong> – numpy.random.Generator instance for the thermostat</p></li>
<li><p><strong>c1</strong> – constant for thermostat</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.bussi_parinello_ld.BussiParinelloLD.add_particle">
<span class="sig-name descname"><span class="pre">add_particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.bussi_parinello_ld.BussiParinelloLD.add_particle" title="Permalink to this definition">¶</a></dt>
<dd><p>Add particle to system</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – list or numpy array with initial position of the particle per dimension</p></li>
<li><p><strong>mass</strong> – mass of particle, defaults to 1.0</p></li>
<li><p><strong>partnum</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – specifies particle number (position in list). Default is -1 (at end)</p></li>
<li><p><strong>overwrite</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – overwrite existing particle instead of inserting (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – when dimensions of pos and potential do not match</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.bussi_parinello_ld.BussiParinelloLD.remove_particle">
<span class="sig-name descname"><span class="pre">remove_particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partnum</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.bussi_parinello_ld.BussiParinelloLD.remove_particle" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes particle from MD</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>partnum</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – specifies particle number in list</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.bussi_parinello_ld.BussiParinelloLD.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.bussi_parinello_ld.BussiParinelloLD.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform single MD step on all particles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Not used, just to have the right function signature</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bdld.actions.delta_f_action">
<span id="bdld-actions-delta-f-action-module"></span><h2>bdld.actions.delta_f_action module<a class="headerlink" href="#module-bdld.actions.delta_f_action" title="Permalink to this heading">¶</a></h2>
<p>Module holding the DeltaFAction class</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.delta_f_action.DeltaFAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.delta_f_action.</span></span><span class="sig-name descname"><span class="pre">DeltaFAction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fes_action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.delta_f_action.DeltaFAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#bdld.actions.action.Action" title="bdld.actions.action.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a></p>
<p>Calculate Delta F from fes and print or save it to file</p>
<p>If no filename is specified this still calculates the values (for possible usage
in other actions) but never actually writes them to file</p>
<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.delta_f_action.DeltaFAction.final_run">
<span class="sig-name descname"><span class="pre">final_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.delta_f_action.DeltaFAction.final_run" title="Permalink to this definition">¶</a></dt>
<dd><p>If not implemented, do nothing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.delta_f_action.DeltaFAction.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.delta_f_action.DeltaFAction.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Delta F from fes and write to file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step, optional</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.delta_f_action.DeltaFAction.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.delta_f_action.DeltaFAction.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write delta F values to file to file</p>
<p>Does nothing if self.filename is empty</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.delta_f_action.calculate_delta_f">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.delta_f_action.</span></span><span class="sig-name descname"><span class="pre">calculate_delta_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.delta_f_action.calculate_delta_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the free energy difference between states defined by boolean masks</p>
<p>If more than two are specified, this returns the difference to the first state for all others</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – free energy surface to examine</p></li>
<li><p><strong>kt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – energy in units of kT</p></li>
<li><p><strong>masks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – a list of boolean numpy arrays resembling the states</p></li>
</ul>
</dd>
<dt class="field-even">Return delta_F<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of doubles containing the free energy difference to the first state</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IndexError</strong> – if the dimensions of the FES and any of the masks do not match</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.delta_f_action.check_mask_shapes">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.delta_f_action.</span></span><span class="sig-name descname"><span class="pre">check_mask_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.delta_f_action.check_mask_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the shape of all masks is equal to the shape of the FES</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bdld.actions.fes_action">
<span id="bdld-actions-fes-action-module"></span><h2>bdld.actions.fes_action module<a class="headerlink" href="#module-bdld.actions.fes_action" title="Permalink to this heading">¶</a></h2>
<p>Module holding the FesAction class</p>
<p>Also holds functions for calculating and plotting the FES</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.fes_action.FesAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.fes_action.</span></span><span class="sig-name descname"><span class="pre">FesAction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histo_action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.FesAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#bdld.actions.action.Action" title="bdld.actions.action.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a></p>
<p>Calculate fes from histogram and save to file</p>
<p>The actual FES is not a data member of this class but rather a member of the
Histogram instance of the passed histo_action.
This is mostly for historical reasons, as the Histogram class existed before
the code was restructured into actions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fes</strong> – Grid instance hosting the FES</p></li>
<li><p><strong>kt</strong> – thermal energy in units of kT</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.fes_action.FesAction.final_run">
<span class="sig-name descname"><span class="pre">final_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.FesAction.final_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as run() but without stride checks and passing the step number</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.fes_action.FesAction.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.FesAction.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fes with reference and optionally save to file</p>
<p>If a step is specified it will be appended to the filename, i.e. it is written
to a new file. It will also be used for the plot title</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – current simulation step, optional</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.fes_action.FesAction.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.FesAction.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate fes from histogram, write to file and plot if matching strides</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step, optional</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.fes_action.FesAction.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.FesAction.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write fes to file</p>
<p>If a step is specified it will be appended to the filename, i.e. it is written
to a new file.
If no filename is set, this will do nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – current simulation step, optional</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.fes_action.calculate_fes">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.fes_action.</span></span><span class="sig-name descname"><span class="pre">calculate_fes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mintozero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.calculate_fes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate free energy surface from histogram</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histo</strong> (<a class="reference internal" href="bdld.html#bdld.histogram.Histogram" title="bdld.histogram.Histogram"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram</span></code></a>) – Histogram instance to calculate FES from</p></li>
<li><p><strong>kt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – thermal energy of the system</p></li>
<li><p><strong>mintozero</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – shift FES to have minimum at zero</p></li>
</ul>
</dd>
<dt class="field-even">Return fes<span class="colon">:</span></dt>
<dd class="field-even"><p>Grid with the fes values as data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="bdld.html#bdld.grid.Grid" title="bdld.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.fes_action.plot_fes">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.fes_action.</span></span><span class="sig-name descname"><span class="pre">plot_fes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.plot_fes" title="Permalink to this definition">¶</a></dt>
<dd><p>Show fes with matplotlib</p>
<p>Does work with 1D and 2D fes, higher dimensions will be ignored without error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – the fes to plot</p></li>
<li><p><strong>axes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – axes of plot</p></li>
<li><p><strong>ref</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – optional reference FES to plot (makes only sense for 1d fes)</p></li>
<li><p><strong>plot_domain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – optional Tuple with minimum and maximum value to show</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – optional filename to save figure to</p></li>
<li><p><strong>title</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – optional title for the legend</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bdld.actions.fes_action.save_fig_interactive">
<span class="sig-prename descclassname"><span class="pre">bdld.actions.fes_action.</span></span><span class="sig-name descname"><span class="pre">save_fig_interactive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.fes_action.save_fig_interactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Ask for filename to save file to</p>
</dd></dl>

</section>
<section id="module-bdld.actions.histogram_action">
<span id="bdld-actions-histogram-action-module"></span><h2>bdld.actions.histogram_action module<a class="headerlink" href="#module-bdld.actions.histogram_action" title="Permalink to this heading">¶</a></h2>
<p>Module holding the HistogramAction class</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.histogram_action.HistogramAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.histogram_action.</span></span><span class="sig-name descname"><span class="pre">HistogramAction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.histogram_action.HistogramAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#bdld.actions.action.Action" title="bdld.actions.action.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a></p>
<p>Action collecting trajectory data into a histogram</p>
<p>The Histogram data member is periodically enhanced with the new data from
the trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histo</strong> – Histogram data</p></li>
<li><p><strong>update_stride</strong> – add trajectory data every n time steps</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.histogram_action.HistogramAction.final_run">
<span class="sig-name descname"><span class="pre">final_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.histogram_action.HistogramAction.final_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as run without stride checks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.histogram_action.HistogramAction.get_traj_data">
<span class="sig-name descname"><span class="pre">get_traj_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.histogram_action.HistogramAction.get_traj_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the right data from the trajectory array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.histogram_action.HistogramAction.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.histogram_action.HistogramAction.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Add trajectory data to histogram and write to file if strides are matched</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.histogram_action.HistogramAction.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.histogram_action.HistogramAction.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write histogram to file</p>
<p>If a step is specified it will be appended to the filename,
i.e. it is written to a new file
If no filename is set, this will do nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – current simulation step, optional</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bdld.actions.trajectory_action">
<span id="bdld-actions-trajectory-action-module"></span><h2>bdld.actions.trajectory_action module<a class="headerlink" href="#module-bdld.actions.trajectory_action" title="Permalink to this heading">¶</a></h2>
<p>Module holding the TrajectoryAction class</p>
<dl class="py class">
<dt class="sig sig-object py" id="bdld.actions.trajectory_action.TrajectoryAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bdld.actions.trajectory_action.</span></span><span class="sig-name descname"><span class="pre">TrajectoryAction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.trajectory_action.TrajectoryAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#bdld.actions.action.Action" title="bdld.actions.action.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a></p>
<p>Class that stories trajectories and writes them to file</p>
<p>The write_stride parameter determines how many trajectory
points are being held in memory even if they are never written.
This allow other actions to use them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>traj</strong> – fixed size numpy array holding the time and positions
it is written row-wise (i.e. every row represents a time)
and overwritten after being saved to file</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.trajectory_action.TrajectoryAction.final_run">
<span class="sig-name descname"><span class="pre">final_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.trajectory_action.TrajectoryAction.final_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write rest of trajectories to files</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.trajectory_action.TrajectoryAction.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.trajectory_action.TrajectoryAction.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Store positions in traj array and write to file if write_stride is matched</p>
<p>The stride parameters is ignored here and all times are temporarily stored
This is because a HistogramAction using the data might have a different stride</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bdld.actions.trajectory_action.TrajectoryAction.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bdld.actions.trajectory_action.TrajectoryAction.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write currently stored trajectory data to file</p>
<p>This can also be called between regular saves (e.g. at the end of the simulation)
and will not result in missing or duplicate data
Because the trajectories are stored in the array independently from the writes
the function needs to do some arithmetics to find out what to write</p>
<p>If no filenames were set this function will do nothing but not raise an exception</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current simulation step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bdld.actions">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bdld.actions" title="Permalink to this heading">¶</a></h2>
<p>Import all submodules when importing the actions module</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Birth-Death Langevin Dynamics</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input.html">Input file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Information for developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Benjamin Pampel.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/source/bdld.actions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>